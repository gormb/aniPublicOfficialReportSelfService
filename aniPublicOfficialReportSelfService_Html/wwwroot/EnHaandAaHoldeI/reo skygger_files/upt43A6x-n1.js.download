;/*FB_PKG_DELIM*/

__d("EBWorkerODSEntityName.enum",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({MW_EBSM_HYDRATION:"mw_ebsm_hydration",MW_EBSM_IDB:"mw_eb_ebsm_idb",MW_EBSM_CORRUPTION:"mw_ebsm_corruption",MW_EBSM_RESTORE_PERSISTENCE_ERROR:"mw_ebsm_restore_persistence",MW_EBSM_IDB_TABLE_DELETION:"mw_ebsm_idb_table_deletion",MW_EB_AUTO_RESTORE_AUTH_WORKER:"mw_eb_auto_restore_auth_worker",MW_EB_AUTO_RESTORE_AUTH_MAIN_THREAD:"mw_eb_auto_restore_auth_main_thread",MW_EB_DEVICE_MIGRATION_WORKER:"mw_eb_device_migration_worker",EB_WORKER_ADD_DEVICE_WITH_KEYS:"eb_worker_add_device_with_keys",EB_WORKER_ADD_DEVICE_WITH_RC:"eb_worker_add_device_with_rc",EB_WORKER_OPT_OUT:"eb_worker_opt_out"});c=a;f["default"]=c}),66);
__d("LSCookie",["$InternalEnum","Cookie","CookieCore","CurrentEnvironment","CurrentMessengerUser","FBLogger","I64","LSE2EEMetadataSyncGroupUtils","LSIntEnum","MessengerLogHistory","MqttWebDeviceID","ReQL","SortedAsyncIterable","isPromise","isStringNullOrEmpty","pageID","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=b("$InternalEnum")({SYNCING:"1",NOT_SYNCING:"0"}),l=d("MessengerLogHistory").getInstance("client_init"),m=c("CurrentEnvironment").instagramdotcom?"igd_ls":"m_ls",n={c:{},d:c("MqttWebDeviceID").clientID,s:k.NOT_SYNCING,u:c("pageID")};function o(a){function b(a){d("CookieCore").setWithDomain_FOR_MESSENGER_LS_ONLY(m,JSON.stringify(a),window.location.hostname)}var e=c("Cookie").get(m);if(e==null){var f;b((f={},f[d("CurrentMessengerUser").getIDorEIMU()]=a,f));return}f=JSON.parse(e);if(f.u==null){b(babelHelpers["extends"]({},f,(e={},e[d("CurrentMessengerUser").getIDorEIMU()]=a,e)))}else{b((f={},f[d("CurrentMessengerUser").getIDorEIMU()]=a,f))}}function a(){c("Cookie").clear(m)}function p(a){if(typeof a!=="object")return null;if(a==null)return null;var b=a.c,c=a.d,d=a.s;a=a.u;d=typeof d==="string"?k.cast(d):null;b=typeof b==="object"&&b!=null?Object.entries(b).reduce(function(a,b){var c=b[0];b=b[1];if(a==null||typeof b!=="string")return null;a[c]=b;return a},{}):null;if(typeof c!=="string")return null;if(d==null)return null;if(b==null)return null;return typeof a!=="string"?null:{c:b,d:c,s:d,u:a}}function q(){var a=c("Cookie").get(m);if(c("isStringNullOrEmpty")(a))return n;a=JSON.parse(a);var b=d("CurrentMessengerUser").getIDorEIMU(),e=p(a);a=typeof a==="object"&&a!=null?p(a[b]):null;return(a=(b=a)!=null?b:e)!=null?a:n}function r(a){var b=q();if(b.u!==c("pageID"))return;var e={};a.forEach(function(a){a[0];a=a[1];var b=a.currentCursor;a=a.groupId;b!=null&&(e[(i||(i=d("I64"))).to_string(a)]=b)});l.debug("Updated sync cookie to set syncing=false, saving latest cursors");o(babelHelpers["extends"]({},b,{c:e,s:k.NOT_SYNCING}))}var s=[1,2,d("LSE2EEMetadataSyncGroupUtils").shouldAlwaysResetE2EEMetadata()?null:95];function e(a){var b=d("SortedAsyncIterable").toArray(d("ReQL").union.apply(void 0,s.map(function(b){return b==null?d("ReQL").empty():d("ReQL").fromTableAscending(a.tables.sync_groups).getKeyRange((j||(j=d("LSIntEnum"))).ofNumber(b))})));if((h||(h=c("isPromise")))(b)){c("promiseDone")(b.then(function(a){r(a)}));return}r(b)}function f(){try{var a=q();l.debug("Updated sync cookie to set syncing=true");o(babelHelpers["extends"]({},a,{s:k.SYNCING,u:c("pageID")}))}catch(a){c("FBLogger")("ls_web_init").catching(a).warn("Failed to sync cookie")}}g.Status=k;g.DEFAULT_COOKIE=n;g.clear=a;g.get=q;g.syncBeforeUnload=e;g.setSyncing=f}),98);
__d("LSDatabaseProviderType",[],(function(a,b,c,d,e,f){"use strict";function a(a){return g(a.persistenceTypes)}function g(a){return a.includes("indexeddb")}f.isProviderPersisted=a;f.hasPersistentType=g}),66);
__d("LSDedicatedMqttChannel",["FBMqttChannel","cr:1232"],(function(a,b,c,d,e,f,g){"use strict";function a(){b("cr:1232")!=null&&b("cr:1232").shutdownAndClear()}function d(a,d,e,f,g){return function(h){if(b("cr:1232")!=null)return b("cr:1232").getInstance(h,a,d,e,f,g);else return c("FBMqttChannel")}}g.shutdownAndClear=a;g.getInstance=d}),98);
__d("LSFetchBackupIds",["LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFetchBackupIdsStoredProcedure] Beginning execution."),d[11]=c.i64.cast([0,0]),d[7]=d[11],d[8]=new c.Map(),d[8].set("backup_tenancy",a[0]),d[8].set("trace_id",void 0),d[9]=c.toJSON(d[8]),c.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",c.i64.cast([0,50008]),d[9],c.i64.cast([0,0]),c.i64.cast([0,93]),c.i64.cast([0,0]),void 0,d[7]).then(function(a){return a=a,d[10]=a[0],a})},function(a){return d[1]=c.i64.of_float(Date.now()),d[2]=c.i64.random(),d[4]="Finishing execution. Execution time: ",d[5]=c.i64.to_string(c.i64.sub(d[1],d[0])),d[6]=" ms",d[3]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsFetchBackupIdsStoredProcedure] ",d[3],d[4],d[3],d[5],d[3],d[6]].join("")),c.i64.eq(c.i64.mod_(d[2],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[7]=",",d[8]=c.createArray(),void 0!==void 0?d[9]=(d[8].push(void 0),d[8]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFetchBackupIdsStoredProcedure",[d[4],d[7],d[5],d[7],d[6]].join(""),d[8],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsFetchBackupIdsStoredProcedure";a.__tables__=["encrypted_backups"];e.exports=a}),null);
__d("LSFetchBackupIdsStoredProcedure",["LSFetchBackupIds","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSFetchBackupIds"),e.backupTenancy,e.traceId,e.isUiBlocking);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSGetLatestEpochKeys",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][getLatestEpochKeys] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]="",d[3]=void 0,d[4]=void 0,a[0]?c.resolve(0):(d[14]=void 0,c.i64.neq(d[14],void 0)?c.db.table(169).fetch([[[d[14]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?0:(b=a.item,d[2]=c.blobs.to_string(b.epochAnonIdBlob),d[3]=b.epochId,d[4]=b.epochRootKeyBlob)}):c.resolve())},function(b){return c.i64.neq(d[3],void 0)?c.resolve(0):c.forEach(c.filter(c.db.table(169).fetch(),function(b){return a[0]||c.i64.eq(b.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[15]=c.blobs.to_string(a.epochAnonIdBlob),c.i64.eq([0,d[15].length],[0,d[2].length])?d[14]=d[15]>d[2]:d[14]=c.i64.gt([0,d[15].length],[0,d[2].length]),d[14]?(d[2]=d[15],d[3]=a.epochId,d[4]=a.epochRootKeyBlob,d[16]=c.i64.of_float(Date.now()),0):0})},function(a){return d[10]=c.blobs.of_string(d[2]),c.i64.neq(d[3],void 0)?(c.blobs.neq(d[10],void 0)?(c.blobs.neq(d[4],void 0)?(d[18]=new c.Map(),d[18].set("epoch_id",d[3]),d[18].set("epoch_root_key",d[4]),d[18].set("epoch_anon_id",d[10]),d[19]=new c.Map(),d[19].set("epoch_keys",d[18]),a=[d[19],void 0],d[16]=a[0],d[17]=a[1],a):(d[18]=new c.Map(),d[18].set("error_code",c.i64.cast([0,402])),d[18].set("error_message","failed to query latest epoch"),d[18].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,d[18]],d[16]=a[0],d[17]=a[1],a),a=[d[16],d[17]],d[14]=a[0],d[15]=a[1],a):(d[16]=new c.Map(),d[16].set("error_code",c.i64.cast([0,403])),d[16].set("error_message","failed to query latest epoch"),d[16].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,d[16]],d[14]=a[0],d[15]=a[1],a),a=[d[14],d[15]],d[5]=a[0],d[6]=a[1],a):(d[14]=new c.Map(),d[14].set("error_code",c.i64.cast([0,400])),d[14].set("error_message","failed to query latest epoch"),d[14].set("stored_procedure","LSEncryptedBackupsGetLatestEpochKeysStoredProcedure"),a=[void 0,d[14]],d[5]=a[0],d[6]=a[1],a),d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[11]="Finishing execution. Execution time: ",d[12]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[13]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][getLatestEpochKeys] ",d[9],d[11],d[9],d[12],d[9],d[13]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[14]=",",d[15]=c.createArray(),void 0!==void 0?d[16]=(d[15].push(void 0),d[15]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"getLatestEpochKeys",[d[11],d[14],d[12],d[14],d[13]].join(""),d[15],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsGetLatestEpochKeysStoredProcedure";a.__tables__=["secure_encrypted_backups_epochs"];e.exports=a}),null);
__d("LSMailboxTaskCompletionApiOnTaskCompletion",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(233).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({success:a[1]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSCoreMailboxTaskCompletionApiOnTaskCompletionStoredProcedure";a.__tables__=["mailbox_task_completion_api_tasks"];e.exports=a}),null);
__d("LSPlatformDefaultUnderlyingApi",["Promise","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return c("emptyFunction")}function d(){return(h||(h=b("Promise"))).resolve()}e={cleanup:c("emptyFunction"),logEvent:function(a){},onConnectionStatusChange:a,onReconnect:a,publish:d,subscribe:a};g["default"]=e}),98);
__d("LSPlatformDeviceId",["ChannelClientID","FBLogger","LSCookie","MqttWebDeviceID","gkx"],(function(a,b,c,d,e,f,g){"use strict";function h(){if(c("gkx")("21118"))return c("MqttWebDeviceID").clientID;else return c("ChannelClientID").getID()}b=h();function a(a){a==null&&c("FBLogger")("messenger_browser_clients").info("Missed provider type for deviceId");return a==="persisted"?d("LSCookie").get().d:h()}g.deviceId=b;g.getDeviceIdForProviderType=a}),98);
__d("MessengerPWAVersionForUserAgent",["isMessengerPWA","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){if(!c("justknobx")._("3005"))return void 0;var a=c("isMessengerPWA")();if(!a)return void 0;a=(a=new URL(window.location.href).searchParams.get("__pwa"))!=null?a:"1.0.0";return a}g["default"]=a}),98);
__d("LSPlatformRealtimeTransport",["I64","LSDynamicDependencies","LSIntEnum","LSJson","LSMailboxInitialSyncCursor","LSShape","MessengerPWAVersionForUserAgent","Promise","clearTimeout","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;e="LSPlatformRealtimeTransport.NotConnected";var k="LSPlatformRealtimeTransport.Timeout";function l(a){var b=new Map();return{getAll:function(){return Array.from(b.values())},getOrStart:function(c){var d=c.toString(),e=b.get(d);e==null&&(e=a(c),b.set(d,e));return e}}}function m(){}function a(a,e,f){var g=new Map(),n={contents:m},o=new Set(),p=new Map(),q=[],r=l(function(b){b=a(b,f);q.push(b.subscribe(function(a){var b=JSON.parse(a),e=d("LSDynamicDependencies").downloadBootloaderDependencies(b.sp,b.nop,b.ntop);a=b.request_id;var f;if(a!=null){var h=g.get(a);h==null?f=!1:(c("clearTimeout")(h.timeoutId),h.resolve({downloadTask:e,payload:b,type:"taskresponse"}),g["delete"](a),f=!0)}else f=!1;if(!f){Array.from(p.entries()).forEach(function(a){return a[1](e,b)});return}}));q.push(b.onReconnect(function(){return n.contents()}));q.push(b.onConnectionStatusChange(function(a){o.forEach(function(b){return b(a)})}));return b});r.getOrStart((j||(j=d("LSIntEnum"))).unwrapIntEnum(d("LSMailboxInitialSyncCursor").syncChannel));return{cleanup:function(){q.forEach(function(a){return a()}),r.getAll().forEach(function(a){return a.cleanup()})},logEvent:function(a){r.getAll().forEach(function(b){return b.logEvent(a)})},onConnectionStatusChange:function(a){o.add(a);return function(){o["delete"](a)}},onReconnect:function(a){n.contents=a;return function(){n.contents=m}},publish:function(a){var f=a.payload,l=a.queueName,m=a.requestId,n=a.syncChannel,o=a.type_;return new(h||(h=b("Promise")))(function(a,b){var h=r.getOrStart((j||(j=d("LSIntEnum"))).unwrapIntEnum(n));if((i||(i=d("I64"))).equal(o,(j||(j=d("LSIntEnum"))).ofNumber(3))){var p=c("setTimeout")(function(){h.logEvent("Timeout");var a=g.get(m);a!=null&&(g["delete"](m),a.reject({RE_EXN_ID:k}));return b({RE_EXN_ID:k})},3e4);g.set(m,{queueName:l,reject:b,resolve:a,timeoutId:p,timestamp:Date.now()})}p=c("MessengerPWAVersionForUserAgent")();c("promiseDone")(h.publish(d("LSJson").stringify(d("LSShape").ofRecord(babelHelpers["extends"]({app_id:e,payload:f},p!=null?{pwa_version:p}:{},{request_id:m,type:o}))),o),function(){if(!(i||(i=d("I64"))).equal(o,(j||(j=d("LSIntEnum"))).ofNumber(3)))return a({type:"noresponseexpected"})},function(a){return b(a)})})},subscribeToNonTaskResponses:function(a){var b={};p.set(b,a);return function(){p["delete"](b)}}}}g.NotConnected=e;g.Timeout=k;g.LSPlatformRealtimeTransport=a}),98);
__d("shouldStubUnderlyingTransport",["ExecutionEnvironment"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return!(h||(h=c("ExecutionEnvironment"))).canUseDOM&&!(h||(h=c("ExecutionEnvironment"))).isInWorker}g["default"]=a}),98);
__d("LSPlatformMqttRealtimeTransport",["I64","LSIntEnum","LSPlatformDefaultUnderlyingApi","LSPlatformRealtimeTransport","Promise","promiseDone","shouldStubUnderlyingTransport"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a){return[{payload:JSON.stringify({ls_fdid:"",ls_sv:a}),qos:1,topic:"/ls_app_settings"}]}function l(a){var e={contents:a.getConnectionState()},f={contents:function(){}},g={contents:new(j||(j=b("Promise")))(function(a,b){f.contents=a})},k={onMQTTStateChanged:function(a){a==="Connected"?f.contents():a==="Disconnected"&&e.contents==="Connected"&&(g.contents=new(j||(j=b("Promise")))(function(a,b){f.contents=a})),e.contents=a}};e.contents==="Connected"&&f.contents();a.subscribeChannelEvents(k);return[function(){a.unsubscribeChannelEvents(k)},function(e,f){return g.contents.then(function(){return new(j||(j=b("Promise")))(function(b,g){c("promiseDone")(a.publish("/ls_req",e,{listener:{onEvent:function(a){if(a==="NOT_CONNECTED")return g({RE_EXN_ID:d("LSPlatformRealtimeTransport").NotConnected})}},qos:(h||(h=d("I64"))).equal(f,(i||(i=d("LSIntEnum"))).ofNumber(4))?0:1,skipBuffer:!1}),function(){return b()},function(a){if(a.message==="Publish Timed Out")return g({RE_EXN_ID:d("LSPlatformRealtimeTransport").Timeout});else return g(a)})})})}]}var m={contents:void 0};function a(a,b,d){if(c("shouldStubUnderlyingTransport")())return c("LSPlatformDefaultUnderlyingApi");var e=d.getInstance(b),f={getPublishMessages:function(){return k(a)}};e.registerExtraConnectPayloadProvider(f);var g={onMQTTStateChanged:function(a){var b=m.contents;if(b!=null)return b(a)}};e.subscribeChannelEvents(g);var h=e.subscribe("/ls_foreground_state",function(){});b=l(e);var i=b[0];b=b[1];return{cleanup:function(){e.unregisterExtraConnectPayloadProvider(f),d.shutdownAndClear(),e.unsubscribeChannelEvents(g),h(),i()},logEvent:function(a){},onConnectionStatusChange:function(a){m.contents=a;return function(){m.contents=void 0}},onReconnect:function(a){var b={contents:e.getConnectionState()},c={contents:b.contents==="Connected"},d={onMQTTStateChanged:function(d){d==="Connected"&&(c.contents&&b.contents!=="Connected"&&a(),c.contents=!0),b.contents=d}};e.subscribeChannelEvents(d);return function(){e.unsubscribeChannelEvents(d)}},publish:b,subscribe:function(a){return e.subscribe("/ls_resp",function(b){return a(b)})}}}g["default"]=a}),98);
__d("LSRemoveBlindedTokens",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(308).fetch(),function(b){return b.configId===a[0]}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSAnonymousCredentialsRemoveBlindedTokensStoredProcedure";a.__tables__=["secure_acs_blinded_tokens"];e.exports=a}),null);
__d("LSSymmetricEncryptionCreateEncryptedData.nop",["SymmetricEncryptionCreateEncryptedData"],(function(a,b,c,d,e,f,g){"use strict";a=function(a,b,d,e,f){return c("SymmetricEncryptionCreateEncryptedData")(d,e,f)};a.__nop_name__="LSSymmetricEncryptionCreateEncryptedData";g["default"]=a}),98);
__d("LSSymmetricEncryptionCreateEncryptedString.nop",["Base64Utils","CryptoLogger","LSCryptoUtils","LSSymmetricEncryptionCreateEncryptedData.nop","Promise","RetUtil"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,e,f,g,i){var j=d("CryptoLogger").CryptoLogger("symmetric_encryption_create_encrypted_string");return c("LSSymmetricEncryptionCreateEncryptedData.nop")(a,e,f,g,d("LSCryptoUtils").strToBuf(i)).then(function(a){return a[0]}).then(function(a){return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult(a?d("Base64Utils").fromArrayBuffer(a):void 0))})["catch"](function(a){d("CryptoLogger").captureError(j,a).mustfix("symmetric string encryption failed");return(h||(h=b("Promise"))).resolve(d("RetUtil").getNullableRetResult())})};a.__nop_name__="LSSymmetricEncryptionCreateEncryptedString";g["default"]=a}),98);
__d("LSVoprfLoggingUtils",["Env","MemoryUtils","QPLUserFlow","justknobx","mergeDeep","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=d("MemoryUtils").getCurrentMemory();a=a.usedJSHeapSize;return{"int":{usedJSHeapSizeStart:a}}}function k(a){var b=d("MemoryUtils").getCurrentMemory(),c=b.deviceMemory,e=b.jsHeapSizeLimit,f=b.totalJSHeapSize;b=b.usedJSHeapSize;return{"int":{deviceMemory:c,jsHeapSizeLimit:e,totalJSHeapSize:f,usedJSHeapSize:b,wasmMemorySize:a}}}function l(a){return(h||(h=c("performanceAbsoluteNow")))()-a}function a(a){var b=Math.floor(Math.random()*1e6);return{addPoint:function(d){c("QPLUserFlow").addPoint(a,d,{instanceKey:b})},addTimeSinceCreationAnnotation:function(){},addVoprfLoadedPoint:function(d){c("QPLUserFlow").addPoint(a,"loaded_xplat_react_voprf",{instanceKey:b}),c("QPLUserFlow").addAnnotations(a,{"int":{timeSinceVoprfInstanceCreationNs:l(d)}},{instanceKey:b})},endFailure:function(d){var e=d.error;d=d.wasmMemorySize;c("QPLUserFlow").addAnnotations(a,k(d));c("QPLUserFlow").endFailure(a,e.name,{error:e,instanceKey:b})},endSuccess:function(d){d=d.wasmMemorySize;c("QPLUserFlow").addAnnotations(a,k(d),{instanceKey:b});c("QPLUserFlow").endSuccess(a,{instanceKey:b})},start:function(){c("QPLUserFlow").start(a,{instanceKey:b,onFlowTimeout:function(d,e){c("QPLUserFlow").addAnnotations(a,k(),{instanceKey:b})},timeoutInMs:6e4}),c("QPLUserFlow").addAnnotations(a,c("mergeDeep")(j(),{string:{brsid:c("justknobx")._("3105")&&(i||(i=c("Env"))).brsid!=null?String((i||(i=c("Env"))).brsid):void 0}}),{instanceKey:b})}}}g.getMemoryAnnotationsStart=j;g.getMemoryAnnotationsEnd=k;g.getTimeSinceInstanceCreationNs=l;g.getAcsQplEventLogger=a}),98);
__d("MAWEncryptedBackupsClearRecoveryCode",["Promise","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return(h||(h=b("Promise"))).all([d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.secure_recovery_code_data)),d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.secure_encrypted_backups_recovery_code_status))]).then(function(c){var d=c[0],e=c[1];if(d!=null||e!=null)return a.runInTransaction(function(a){return(h||(h=b("Promise"))).all([(d==null?void 0:d.taskId)!=null?a.secure_recovery_code_data["delete"](d.taskId):(h||(h=b("Promise"))).resolve(),(e==null?void 0:e.pk)!=null?a.secure_encrypted_backups_recovery_code_status["delete"](e.pk):(h||(h=b("Promise"))).resolve()])},"readwrite",void 0,void 0,f.id+":27")})}g.encryptedBackupsClearRecoveryCode=a}),98);
__d("MWChatEncryptedBackupsLogging",["MWEBODSCategory","MWEBODSEntityKey.enum","ODS","QPLUserFlow"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){var b=a.cancelEndPoint,d=a.event,e=a.instanceKey;a=a.source;a!=null&&c("QPLUserFlow").addAnnotations(d,{string:{source:a}},{instanceKey:e});c("QPLUserFlow").addPoint(d,"cancel",{instanceKey:e});c("QPLUserFlow").addAnnotations(d,{string:{cancel_end_point:b}},{instanceKey:e});c("QPLUserFlow").endCancel(d,{instanceKey:e})}function a(a){var b=a.event,d=a.instanceKey,e=a.onClose;a=a.source;a!=null&&c("QPLUserFlow").addAnnotations(b,{string:{source:a}},{instanceKey:d});i({cancelEndPoint:"dialog_x_button",event:b,instanceKey:d});e()}function b(a){var b=a.annotations,e=a.event,f=a.instanceKey;a=a.odsEntityName;c("QPLUserFlow").addPoint(e,"success",{instanceKey:f});c("QPLUserFlow").endSuccess(e,{annotations:b,instanceKey:f});a&&(h||(h=d("ODS"))).bumpEntityKey(c("MWEBODSCategory"),a,c("MWEBODSEntityKey.enum").SUCCESS)}function e(a){var b=a.annotations,e=a.errorName,f=a.event,g=a.instanceKey,i=a.odsEntityKey;a=a.odsEntityName;c("QPLUserFlow").addPoint(f,"failure",{instanceKey:g});c("QPLUserFlow").endFailure(f,e,{annotations:b,instanceKey:g});a&&(h||(h=d("ODS"))).bumpEntityKey(c("MWEBODSCategory"),a,(f=i)!=null?f:c("MWEBODSEntityKey.enum").FAIL)}g.cancelFlow=i;g.closeDialogCancelFlow=a;g.endSuccess=b;g.endFailure=e}),98);
__d("isInstamadilloEB",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("670")===!0}g["default"]=a}),98);
__d("MWEncryptedBackupsListenForChangesToBackupStateInitPath",["EBAPIWorkerCheck","I64","LSAuthorityLevel","LSDataTraceType","LSEncryptedBackupsBackupTenancy","LSFactory","LSFetchBackupIdsStoredProcedure","LSIntEnum","LSIssueMessageRangeQueryTaskStoredProcedure","LSMEBTaskCreationSource","MAWEBRestoreTrackingUtils","MAWMainTraceUtils","MAWOfflineQueueStatus","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsFirstRestoreUpsellTime","MWEncryptedBackupsProcessBackupIdsDEPRECATED","Promise","QPLEvent","QPLUserFlow","ReQL","WAJids","WATagsLogger","WebSession","gkx","isInstamadilloEB","promiseDone","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[EB Prefetch] Issuing message range query for thread "," with params ",""]);l=function(){return a};return a}var m=c("gkx")("23961"),n=c("qex")._("121")===!0;function a(a){function b(){var b=d("ReQL").fromTableAscending(a.tables.encrypted_backups),e=b.subscribe(function(a,b){if(b.operation==="delete"||!(i||(i=d("I64"))).equal(b.value.authorityLevel,(j||(j=d("LSIntEnum"))).ofNumber(c("LSAuthorityLevel").AUTHORITATIVE)))return;e();c("QPLUserFlow").getActiveFlowIDs().includes((k||(k=d("QPLEvent"))).getMarkerId(d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent))&&d("MWChatEncryptedBackupsLogging").endSuccess({event:d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent})});b=d("MWEncryptedBackupsFirstRestoreUpsellTime").getFirstRestoreUpsellTime();c("QPLUserFlow").getActiveFlowIDs().includes((k||(k=d("QPLEvent"))).getMarkerId(d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent))||c("QPLUserFlow").start(d("MWChatEncryptedBackupsQPLEvents").fetchBackupIdsQPLEvent,{annotations:{string:{ebSessionIdentifier:b,fetchBackupIdsVersion:"msys",sessionTabId:d("WebSession").getId()}}});c("promiseDone")(a.runInTransaction(function(a){return c("LSFetchBackupIdsStoredProcedure")(c("LSFactory")(a),{backupTenancy:(j||(j=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION),isUiBlocking:!1})},"readwrite",void 0,void 0,f.id+":93"),function(){return p(a)})}(n||c("isInstamadilloEB")())&&b();var e=d("ReQL").fromTableAscending(a.tables.encrypted_backups_status_trigger);return e.subscribe(b)}function o(a){return a.runInTransaction(function(a){var e=d("MAWOfflineQueueStatus").getAllThreadsWithOfflineQueueIncomplete();return(h||(h=b("Promise"))).all(e.map(function(b){var e=d("WAJids").threadIdForChatJid(b),f=d("MAWMainTraceUtils").createTraceId();c("promiseDone")(d("MAWMainTraceUtils").startTraceWithTxn(a,(i||(i=d("I64"))).of_float(Date.now()),f,(j||(j=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_RESTORE)));e={isPointQuery:!1,newerNumMessages:i.zero,numMessages:i.of_int32(20),source:j.ofNumber(c("LSMEBTaskCreationSource").UNKNOWN),threadId:e,traceId:f};d("WATagsLogger").TAGS(["labyrinth_web","eb_prefetch",f]).LOG(l(),b,JSON.stringify(e));d("MAWEBRestoreTrackingUtils").markEBRestoreFrontloaded(c("LSMEBTaskCreationSource").UNKNOWN,f,!1);return c("LSIssueMessageRangeQueryTaskStoredProcedure")(c("LSFactory")(a),e)}))},"readonly",void 0,void 0,f.id+":122")}function p(a){var b=d("MAWOfflineQueueStatus").isOfflineQueueComplete();m&&!b&&c("promiseDone")(d("MWEncryptedBackupsProcessBackupIdsDEPRECATED").processBackupIdsStoredProcedure(a),function(b){if(c("gkx")("3551")===!0&&d("EBAPIWorkerCheck").runningInWorker())return;b===3&&c("promiseDone")(o(a))})}e={listenForChangesToBackupState:a,preloadEBData:p};g["default"]=e}),98);
__d("XPlatReactVoprf",["Promise","WAWasmModuleCache","asyncToGeneratorRuntime","performanceAbsoluteNow","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSVoprfWasm").__setRef("XPlatReactVoprf");function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a==null?void 0:a.addPoint("build_acs_client_start");var b=(yield j.load()),e=b.LSVoprfWasm,f=b.locateFile;a==null?void 0:a.addPoint("wasm_module_loaded");b=(yield e({getWasmModule:function(){return d("WAWasmModuleCache").loadWasmModule(f())}},a));a==null?void 0:a.addPoint("wasm_module_initialized");var g,h;try{g=b.createCurveRistretto();h=b.createVoprfExpTwohashdh(g);e={voprfInfo:{curvePtr:g,voprfPtr:h},voprfWasm:b};a==null?void 0:a.addPoint("build_acs_client_success");return{instanceCreationTimestampNs:(i||(i=c("performanceAbsoluteNow")))(),voprfInstance:e}}catch(c){a==null?void 0:a.addPoint("build_acs_client_failure");g!=null&&b.freeCurve(g);h!=null&&b.freeVoprf(h);throw c}});return l.apply(this,arguments)}function a(a){return(h||(h=b("Promise"))).resolve(k(a))}function e(a){var b=a.voprfInfo;a=a.voprfWasm;var c=b.curvePtr;b=b.voprfPtr;a.freeCurve(c);a.freeVoprf(b)}g.loadXPlatReactVoprf=a;g.freeVoprfInstance=e}),98);